
```加入event、time列：
import pandas as pd

# 定义文件路径
excel_path = "D:\\zhuomian\\merged_imagename_with_id.xlsx"
csv_path = "D:\\zhuomian\\pyradiomics\\pyradiomics-master\\examples\\output\\final\\radiomics_RB_ID.csv.csv"
output_dir = "D:\\zhuomian\\pyradiomics\\pyradiomics-master\\examples\\output\\final\\"

# 读取Excel文件
excel_df = pd.read_excel(excel_path)

# 读取CSV文件
csv_df = pd.read_csv(csv_path)

# 如果CSV中没有'time'和'event'列，添加它们
if 'time' not in csv_df.columns:
    csv_df['time'] = pd.NA
if 'event' not in csv_df.columns:
    csv_df['event'] = pd.NA

# 设置ID为索引
excel_df.set_index('ID', inplace=True)
csv_df.set_index('ID', inplace=True)

# 更新CSV数据
for idx, row in excel_df.iterrows():
    if idx in csv_df.index:
        csv_df.at[idx, 'time'] = row['time']
        csv_df.at[idx, 'event'] = row['event']

# 重置索引
csv_df.reset_index(inplace=True)

# 保存更新后的CSV文件
csv_df.to_csv(output_dir + 'radiomics_RB_ID_updated.csv', index=False)

```


```獲取圖像名稱保存为excel
import os
import pandas as pd

# 指定包含影像的文件夹路径
image_dir = r"D:\zhuomian\019\018\images_nii"

# 获取文件夹内所有文件的名称
image_names = [f for f in os.listdir(image_dir) if os.path.isfile(os.path.join(image_dir, f))]

# 创建一个DataFrame来存储影像名称及其对应的ID
df = pd.DataFrame({
    'ID': range(1, len(image_names) + 1),
    'Image Name': image_names
})

# 获取图像文件夹的上一层目录
parent_dir = os.path.dirname(image_dir)

# 指定CSV文件的保存路径（保存在图像文件夹的上一层目录下，命名为image_names_with_id.csv）
csv_file_path = os.path.join(parent_dir, 'image_names_with_id.csv')

# 将DataFrame保存为CSV文件
df.to_csv(csv_file_path, index=False)

print(f"CSV file with image names and IDs has been saved at {csv_file_path}")

```



```去掉后缀nii.gz
import pandas as pd

# 文件路径
input_file_path = "D:\\zhuomian\\Dataset021_lung\\image_names_with_updated_id.csv"
output_file_path = "D:\\zhuomian\\Dataset021_lung\\image_names_without_suffix.csv"

# 读取CSV文件
df = pd.read_csv(input_file_path)

# 去除'name'列中的“.nii.gz”后缀
df['name'] = df['name'].str.replace('.nii.gz', '', regex=False)

# 保存修改后的DataFrame为新的CSV文件
df.to_csv(output_file_path, index=False)

print("File saved without .nii.gz suffix at:", output_file_path)

```

```名字都大写
import pandas as pd

# 加载Excel文件
file_path = r"D:\zhuomian\imagename_modified.xlsx"
df = pd.read_excel(file_path)

# 将"name"列下的所有名字转换为大写，并确保名和姓之间有一个空格
df['name'] = df['name'].apply(lambda x: ' '.join(part.upper() for part in x.split()))

# 保存修改后的DataFrame回Excel文件
output_file_path = r"D:\zhuomian\imagename_modified_1.xlsx"
df.to_excel(output_file_path, index=False)

print(f"Modified Excel file has been saved at {output_file_path}")
```

```对应name插入ID
import pandas as pd

# 加载两个Excel文件
imagename_df = pd.read_excel(r"D:\zhuomian\imagename_modified_1.xlsx")
lung_cancer_df = pd.read_excel(r"D:\zhuomian\lung_cancer_modified_uppercase.xlsx")

# 使用merge函数根据name列合并两个DataFrame，这将自动匹配name列并插入对应的ID值
merged_df = pd.merge( lung_cancer_df,imagename_df[['name', 'ID']], on='name', how='left')

# 检查合并后的DataFrame
print(merged_df.head())

# 保存合并后的DataFrame到新的Excel文件
output_file_path = r"D:\zhuomian\merged_imagename_with_id.xlsx"
merged_df.to_excel(output_file_path, index=False)

print(f"Merged Excel file has been saved at {output_file_path}")
```
```对应name插入ID
import pandas as pd

# 加载两个Excel文件
imagename_df = pd.read_csv(r"D:\zhuomian\image_names_without_suffix.csv")
lung_cancer_df = pd.read_excel(r"D:\zhuomian\imagename_modified_1.xlsx")

# 使用merge函数根据name列合并两个DataFrame，这将自动匹配name列并插入对应的ID值
merged_df = pd.merge( lung_cancer_df,imagename_df[['name', 'ID']], on='name', how='left')

# 检查合并后的DataFrame
print(merged_df.head())

# 保存合并后的DataFrame到新的Excel文件
output_file_path = r"D:\zhuomian\merged_imagename_with_id.xlsx"
merged_df.to_excel(output_file_path, index=False)

print(f"Merged Excel file has been saved at {output_file_path}")

```

```提取IMAGE列中的数值赋值为ID
import pandas as pd
import re

# 加载CSV文件
file_path = r"D:\zhuomian\pyradiomics\pyradiomics-master\examples\output\final\radiomics_R1B12_R1B25_R3B12_R3B25_features.csv"
df = pd.read_csv(file_path)

# 定义一个函数来从字符串中提取数字
def extract_number(s):
    # 使用正则表达式查找所有数字
    numbers = re.findall(r'\d+', s)
    # 将找到的数字连接成一个字符串（如果有多个数字的话）
    return ''.join(numbers)

# 应用函数到Image列，提取数字，并创建新的列
df['ID'] = df['Image'].apply(extract_number)

# 显示结果，查看是否正确添加了新列
print(df.head())

# 保存修改后的DataFrame回CSV文件
output_file_path = r"D:\zhuomian\pyradiomics\pyradiomics-master\examples\output\final\radiomics_RB_ID.csv.csv"
df.to_csv(output_file_path, index=False)

```


